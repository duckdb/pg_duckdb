-- All functions should automatically use duckdb
set duckdb.execution = false;
CREATE TABLE dates(w INTERVAL, d DATE, shift INTERVAL, origin DATE);
INSERT INTO dates VALUES
	('10 days', '0794-11-15', '1 week', '0790-11-01'),
	('10 days', '1700-01-01', '0 days', '1700-01-05'),
	('1 week', '1832-05-03', '0 days', '1970-05-05'),
	('10 days', '1897-07-05', '2 days', '1970-06-07'),
	('2 months', '1946-09-14', '0 months', '1970-07-05'),
	('2 months', '2000-01-01', '1 month 1 week', '1970-05-01'),
	('2 year', '2004-05-20', '6 months', '1970-12-31');
select d, time_bucket('3 days'::interval, d) from dates;
     d      | time_bucket 
------------+-------------
 11-15-0794 | 11-15-0794
 01-01-1700 | 12-31-1699
 05-03-1832 | 05-01-1832
 07-05-1897 | 07-04-1897
 09-14-1946 | 09-13-1946
 01-01-2000 | 12-31-1999
 05-20-2004 | 05-20-2004
(7 rows)

select d, time_bucket('3 years'::interval, d) from dates;
     d      | time_bucket 
------------+-------------
 11-15-0794 | 01-01-0794
 01-01-1700 | 01-01-1700
 05-03-1832 | 01-01-1832
 07-05-1897 | 01-01-1895
 09-14-1946 | 01-01-1946
 01-01-2000 | 01-01-2000
 05-20-2004 | 01-01-2003
(7 rows)

select d, time_bucket(null::interval, d) from dates;
     d      | time_bucket 
------------+-------------
 11-15-0794 | 
 01-01-1700 | 
 05-03-1832 | 
 07-05-1897 | 
 09-14-1946 | 
 01-01-2000 | 
 05-20-2004 | 
(7 rows)

select w, d, time_bucket(w, d) from dates;
     w     |     d      | time_bucket 
-----------+------------+-------------
 @ 10 days | 11-15-0794 | 11-11-0794
 @ 10 days | 01-01-1700 | 12-26-1699
 @ 7 days  | 05-03-1832 | 04-30-1832
 @ 10 days | 07-05-1897 | 07-01-1897
 @ 2 mons  | 09-14-1946 | 09-01-1946
 @ 2 mons  | 01-01-2000 | 01-01-2000
 @ 2 years | 05-20-2004 | 01-01-2004
(7 rows)

select d, time_bucket('4 days'::interval, d, '6 hours'::interval) from dates;
     d      | time_bucket 
------------+-------------
 11-15-0794 | 11-13-0794
 01-01-1700 | 12-30-1699
 05-03-1832 | 04-29-1832
 07-05-1897 | 07-01-1897
 09-14-1946 | 09-11-1946
 01-01-2000 | 12-30-1999
 05-20-2004 | 05-17-2004
(7 rows)

select d, time_bucket('2 weeks'::interval, d, '6 days'::interval) from dates;
     d      | time_bucket 
------------+-------------
 11-15-0794 | 11-13-0794
 01-01-1700 | 12-20-1699
 05-03-1832 | 04-29-1832
 07-05-1897 | 06-27-1897
 09-14-1946 | 09-01-1946
 01-01-2000 | 12-26-1999
 05-20-2004 | 05-09-2004
(7 rows)

select d, time_bucket('3 months'::interval, d, '6 days'::interval) from dates;
     d      | time_bucket 
------------+-------------
 11-15-0794 | 10-07-0794
 01-01-1700 | 10-07-1699
 05-03-1832 | 04-07-1832
 07-05-1897 | 04-07-1897
 09-14-1946 | 07-07-1946
 01-01-2000 | 10-07-1999
 05-20-2004 | 04-07-2004
(7 rows)

select d, time_bucket(null::interval, d, '6 days'::interval) from dates;
     d      | time_bucket 
------------+-------------
 11-15-0794 | 
 01-01-1700 | 
 05-03-1832 | 
 07-05-1897 | 
 09-14-1946 | 
 01-01-2000 | 
 05-20-2004 | 
(7 rows)

select time_bucket('3 months'::interval, null::date, '6 days'::interval) from dates;
 time_bucket 
-------------
 
 
 
 
 
 
 
(7 rows)

select d, time_bucket('3 months'::interval, d, null::interval) from dates;
     d      | time_bucket 
------------+-------------
 11-15-0794 | 
 01-01-1700 | 
 05-03-1832 | 
 07-05-1897 | 
 09-14-1946 | 
 01-01-2000 | 
 05-20-2004 | 
(7 rows)

select w, d, shift, time_bucket(w, d, shift) from dates;
     w     |     d      |     shift      | time_bucket 
-----------+------------+----------------+-------------
 @ 10 days | 11-15-0794 | @ 7 days       | 11-08-0794
 @ 10 days | 01-01-1700 | @ 0            | 12-26-1699
 @ 7 days  | 05-03-1832 | @ 0            | 04-30-1832
 @ 10 days | 07-05-1897 | @ 2 days       | 07-03-1897
 @ 2 mons  | 09-14-1946 | @ 0            | 09-01-1946
 @ 2 mons  | 01-01-2000 | @ 1 mon 7 days | 12-08-1999
 @ 2 years | 05-20-2004 | @ 6 mons       | 07-01-2002
(7 rows)

select d, time_bucket('5 days'::interval, d, '1970-01-04'::date) from dates;
     d      | time_bucket 
------------+-------------
 11-15-0794 | 11-15-0794
 01-01-1700 | 12-30-1699
 05-03-1832 | 05-02-1832
 07-05-1897 | 07-05-1897
 09-14-1946 | 09-12-1946
 01-01-2000 | 12-28-1999
 05-20-2004 | 05-20-2004
(7 rows)

select d, time_bucket('3 months'::interval, d, '1970-01-04'::date) from dates;
     d      | time_bucket 
------------+-------------
 11-15-0794 | 10-01-0794
 01-01-1700 | 01-01-1700
 05-03-1832 | 04-01-1832
 07-05-1897 | 07-01-1897
 09-14-1946 | 07-01-1946
 01-01-2000 | 01-01-2000
 05-20-2004 | 04-01-2004
(7 rows)

select d, time_bucket('3 years'::interval, d, '1970-01-04'::date) from dates;
     d      | time_bucket 
------------+-------------
 11-15-0794 | 01-01-0794
 01-01-1700 | 01-01-1700
 05-03-1832 | 01-01-1832
 07-05-1897 | 01-01-1895
 09-14-1946 | 01-01-1946
 01-01-2000 | 01-01-2000
 05-20-2004 | 01-01-2003
(7 rows)

select d, time_bucket(null::interval, d, '1970-01-04'::date) from dates;
     d      | time_bucket 
------------+-------------
 11-15-0794 | 
 01-01-1700 | 
 05-03-1832 | 
 07-05-1897 | 
 09-14-1946 | 
 01-01-2000 | 
 05-20-2004 | 
(7 rows)

select time_bucket('3 years'::interval, null::date, '1970-01-04'::date) from dates;
 time_bucket 
-------------
 
 
 
 
 
 
 
(7 rows)

select d, time_bucket('3 years'::interval, d, null::date) from dates;
     d      | time_bucket 
------------+-------------
 11-15-0794 | 
 01-01-1700 | 
 05-03-1832 | 
 07-05-1897 | 
 09-14-1946 | 
 01-01-2000 | 
 05-20-2004 | 
(7 rows)

select w, d, origin, time_bucket(w, d, origin) from dates;
     w     |     d      |   origin   | time_bucket 
-----------+------------+------------+-------------
 @ 10 days | 11-15-0794 | 11-01-0790 | 11-10-0794
 @ 10 days | 01-01-1700 | 01-05-1700 | 12-26-1699
 @ 7 days  | 05-03-1832 | 05-05-1970 | 05-01-1832
 @ 10 days | 07-05-1897 | 06-07-1970 | 06-29-1897
 @ 2 mons  | 09-14-1946 | 07-05-1970 | 09-01-1946
 @ 2 mons  | 01-01-2000 | 05-01-1970 | 01-01-2000
 @ 2 years | 05-20-2004 | 12-31-1970 | 12-01-2002
(7 rows)

select time_bucket('-3 hours'::interval, '2019-04-05'::date);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Period must be greater than 0
select time_bucket('-3 hours'::interval, '2019-04-05'::date, '1 hour 30 minutes'::interval);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Period must be greater than 0
select time_bucket('-3 hours'::interval, '2019-04-05'::date, '2019-04-05'::date);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Period must be greater than 0
select time_bucket('-1 month'::interval, '2019-04-05'::date);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Period must be greater than 0
select time_bucket('-1 month'::interval, '2019-04-05'::date, '1 week'::interval);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Period must be greater than 0
select time_bucket('-1 month'::interval, '2019-04-05'::date, '2019-04-05'::date);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Period must be greater than 0
select time_bucket('1 day - 172800 seconds'::interval, '2018-05-05'::date);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Period must be greater than 0
select time_bucket('1 day - 172800 seconds'::interval, '2018-05-05'::date, '1 hour 30 minutes'::interval);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Period must be greater than 0
select time_bucket('1 day - 172800 seconds'::interval, '2018-05-05'::date, '2018-05-05'::date);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Period must be greater than 0
select time_bucket('1 month 1 day'::interval, '2018-05-05'::date);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Month intervals cannot have day or time component
select time_bucket('1 month 1 day'::interval, '2018-05-05'::date, '1 week'::interval);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Month intervals cannot have day or time component
select time_bucket('1 month 1 day'::interval, '2019-05-05'::date, '2019-05-05'::date);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Month intervals cannot have day or time component
select time_bucket('3 days'::interval, '2019-05-05'::date, '2000000000 months'::interval);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Conversion Error: Date out of range: -166664648-9-5
select time_bucket('3 days'::interval, '2019-05-05'::date, '-2000000000 months'::interval);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Conversion Error: Date out of range: 166668686-1-5
select time_bucket('3 months'::interval, '2019-05-05'::date, '2000000000 months'::interval);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Conversion Error: Date out of range: -166664648-9-5
select time_bucket('3 months'::interval, '2019-05-05'::date, '-2000000000 months'::interval);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Conversion Error: Date out of range: 166668686-1-5
select time_bucket('1 month'::interval, '5877642-06-25 (BC)'::date);
ERROR:  date out of range: "5877642-06-25 (BC)"
LINE 1: select time_bucket('1 month'::interval, '5877642-06-25 (BC)'...
                                                ^
select time_bucket('1 month'::interval, '5877642-07-01 (BC)'::date);
ERROR:  date out of range: "5877642-07-01 (BC)"
LINE 1: select time_bucket('1 month'::interval, '5877642-07-01 (BC)'...
                                                ^
select time_bucket('1 week'::interval, '5877642-07-01 (BC)'::date);
ERROR:  date out of range: "5877642-07-01 (BC)"
LINE 1: select time_bucket('1 week'::interval, '5877642-07-01 (BC)':...
                                               ^
select time_bucket('1 month'::interval, '5881580-07-10'::date, '-1 day'::interval);
ERROR:  date out of range: "5881580-07-10"
LINE 1: select time_bucket('1 month'::interval, '5881580-07-10'::dat...
                                                ^
select time_bucket('1 month'::interval, '5881580-07-10'::date);
ERROR:  date out of range: "5881580-07-10"
LINE 1: select time_bucket('1 month'::interval, '5881580-07-10'::dat...
                                                ^
select time_bucket('1 week'::interval, '290309-12-21 (BC)'::date);
ERROR:  date out of range: "290309-12-21 (BC)"
LINE 1: select time_bucket('1 week'::interval, '290309-12-21 (BC)'::...
                                               ^
select time_bucket('1 week'::interval, '290309-12-22 (BC)'::date);
ERROR:  date out of range: "290309-12-22 (BC)"
LINE 1: select time_bucket('1 week'::interval, '290309-12-22 (BC)'::...
                                               ^
select time_bucket('1 day'::interval, '290309-12-21 (BC)'::date);
ERROR:  date out of range: "290309-12-21 (BC)"
LINE 1: select time_bucket('1 day'::interval, '290309-12-21 (BC)'::d...
                                              ^
select time_bucket('1 day'::interval, '290309-12-22 (BC)'::date);
ERROR:  date out of range: "290309-12-22 (BC)"
LINE 1: select time_bucket('1 day'::interval, '290309-12-22 (BC)'::d...
                                              ^
select time_bucket('1 week'::interval, '294247-01-11'::date);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Invalid Input Error: Type INT32 with value 294247-01-11 can't be cast to the destination type INT64
select time_bucket('1 week'::interval, '294247-01-10'::date);
 time_bucket  
--------------
 01-04-294247
(1 row)

select time_bucket('1 day'::interval, '294247-01-11'::date);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Invalid Input Error: Type INT32 with value 294247-01-11 can't be cast to the destination type INT64
select time_bucket('1 day'::interval, '294247-01-10'::date);
 time_bucket  
--------------
 01-10-294247
(1 row)

select time_bucket('1 month 1 day'::interval, null::date);
 time_bucket 
-------------
 
(1 row)

select time_bucket('1 month 1 day'::interval, null::date, '6 days'::interval);
 time_bucket 
-------------
 
(1 row)

select time_bucket('1 month 1 day'::interval, null::date, '2022-12-20'::date);
 time_bucket 
-------------
 
(1 row)

select time_bucket('-1 month'::interval, null::date);
 time_bucket 
-------------
 
(1 row)

select time_bucket('-1 month'::interval, null::date, '6 days'::interval);
 time_bucket 
-------------
 
(1 row)

select time_bucket('-1 month'::interval, '2022-12-22'::date, null::interval);
 time_bucket 
-------------
 
(1 row)

select time_bucket('-1 month'::interval, null::date, '2022-12-20'::date);
 time_bucket 
-------------
 
(1 row)

select time_bucket('-1 month'::interval, '2022-12-22'::date, null::date);
 time_bucket 
-------------
 
(1 row)

CREATE TABLE timestamps(w INTERVAL, t TIMESTAMP, shift INTERVAL, origin TIMESTAMP);
INSERT INTO timestamps VALUES ('10 days', '-infinity', '0 days', '1970-01-05 00:00:00'),
	('10 days', '3000-01-02 (BC) 03:16:23.003003', '3 days', '3000-01-01 (BC) 00:00:00'),
	('2 months', '1024-04-10 (BC) 12:35:40.003003', '10 days', '1024-03-01 (BC) 00:00:00'),
	('10 days', '0044-06-15 (BC) 12:35:40.003003', '6 days', '0044-02-01 (BC) 00:00:00'),
	('333 microseconds', '0678-06-30 02:02:03.003003', '0 microseconds', '1970-02-10 00:00:00'),
	('333 microseconds', '0794-07-03 02:02:04.003003', '444 microseconds', '1970-10-17 00:05:05.006006'),
	('333 microseconds', '1700-01-01 00:00:00', '-444 microseconds', '1970-09-27 00:05:05.006006'),
	('333 milliseconds', '1962-12-31 00:00:00', '0 milliseconds', '1970-08-12 00:00:00'),
	('333 milliseconds', '1970-01-01 00:00:00', '444 milliseconds', '1970-06-23 00:05:05.006006'),
	('333 milliseconds', '1985-12-07 02:02:08.003003', '-444 milliseconds', '1970-01-05 00:05:05.006006'),
	('333 seconds', '1989-10-18 02:02:09.003003', '0 seconds', '1970-09-07 00:00:00'),
	('333 seconds', '1990-01-21 02:02:10.003003', '444 seconds', '1970-07-06 00:05:05.006006'),
	('333 seconds', '1991-02-10 02:02:11.003003', '-444 seconds', '1970-10-09 00:05:05.006006'),
	('333 minutes', '1992-09-11 02:02:12.003003', '0 minutes', '1970-04-10 00:00:00'),
	('333 minutes', '1994-12-26 02:02:13.003003', '444 minute', '1970-03-05 00:05:05.006006'),
	('333 minutes', '1997-05-13 02:02:14.003003', '-444 minute', '2000-01-03 00:00:00'),
	('333 hours', '1999-02-14 02:02:15.003003', '0 hours', '2000-01-01 00:00:00'),
	('333 hours', '2000-01-01 00:00:00', '444 hours', '1980-11-25 00:05:05.006006'),
	('333 hours', '2000-01-03 00:00:00', '-444 hours', '2045-01-05 00:05:05.006006'),
	('10 days', '2008-09-17 02:02:18.003003', '0 days', '2009-11-05 00:00:00'),
	('1 week', '2010-08-18 02:02:19.003003', '0 days', '2100-09-05 00:00:00'),
	('10 days', '2013-03-19 02:02:20.003003', '2 days 4 hours', '2300-10-07 00:05:05.006006'),
	('10 days', '2014-11-20 02:02:21.003003', '-2 days 4 hours', '1970-12-07 00:05:05.006006'),
	('2 months', '2016-02-21 02:02:22.003003', '0 months', '1970-09-05 00:00:00'),
	('2 months', '2018-08-22 02:02:23.003003', '1 month 1 week', '1970-07-01 00:05:05.006006'),
	('2 months', '2019-01-23 02:02:24.003003', '-1 month 1 week', '1969-09-01 00:05:05.006006'),
	('2 year', '2020-02-24 02:02:25.003003', '6 months', '1970-02-13 00:05:05.006006'),
	('2 year', '2022-07-25 02:02:26.003003', '-6 months', '1969-10-09 00:05:05.006006'),
	('10 days', '2024-02-25 02:02:26.003003', '1 year', '-infinity'),
	('10 days', '2032-09-25 02:02:26.003003', '-1 year', 'infinity'),
	('10 days', 'infinity', '0 days', '1970-01-01 00:00:00');
select t, time_bucket('56 seconds'::interval, t) from timestamps;
                 t                  |            time_bucket            
------------------------------------+-----------------------------------
 -infinity                          | Tue Jan 09 04:00:21.551616 294277
 Fri Jan 02 03:16:23.003003 3000 BC | Fri Jan 02 03:15:36 3000 BC
 Thu Apr 10 12:35:40.003003 1024 BC | Thu Apr 10 12:35:28 1024 BC
 Sat Jun 15 12:35:40.003003 0044 BC | Sat Jun 15 12:34:48 0044 BC
 Sun Jun 30 02:02:03.003003 0678    | Sun Jun 30 02:01:12 0678
 Sun Jul 03 02:02:04.003003 0794    | Sun Jul 03 02:01:12 0794
 Fri Jan 01 00:00:00 1700           | Thu Dec 31 23:59:36 1699
 Mon Dec 31 00:00:00 1962           | Mon Dec 31 00:00:00 1962
 Thu Jan 01 00:00:00 1970           | Wed Dec 31 23:59:28 1969
 Sat Dec 07 02:02:08.003003 1985    | Sat Dec 07 02:02:00 1985
 Wed Oct 18 02:02:09.003003 1989    | Wed Oct 18 02:01:36 1989
 Sun Jan 21 02:02:10.003003 1990    | Sun Jan 21 02:02:08 1990
 Sun Feb 10 02:02:11.003003 1991    | Sun Feb 10 02:02:08 1991
 Fri Sep 11 02:02:12.003003 1992    | Fri Sep 11 02:01:52 1992
 Mon Dec 26 02:02:13.003003 1994    | Mon Dec 26 02:01:20 1994
 Tue May 13 02:02:14.003003 1997    | Tue May 13 02:01:28 1997
 Sun Feb 14 02:02:15.003003 1999    | Sun Feb 14 02:02:08 1999
 Sat Jan 01 00:00:00 2000           | Fri Dec 31 23:59:44 1999
 Mon Jan 03 00:00:00 2000           | Mon Jan 03 00:00:00 2000
 Wed Sep 17 02:02:18.003003 2008    | Wed Sep 17 02:01:36 2008
 Wed Aug 18 02:02:19.003003 2010    | Wed Aug 18 02:01:36 2010
 Tue Mar 19 02:02:20.003003 2013    | Tue Mar 19 02:01:28 2013
 Thu Nov 20 02:02:21.003003 2014    | Thu Nov 20 02:01:44 2014
 Sun Feb 21 02:02:22.003003 2016    | Sun Feb 21 02:02:08 2016
 Wed Aug 22 02:02:23.003003 2018    | Wed Aug 22 02:01:36 2018
 Wed Jan 23 02:02:24.003003 2019    | Wed Jan 23 02:01:36 2019
 Mon Feb 24 02:02:25.003003 2020    | Mon Feb 24 02:02:16 2020
 Mon Jul 25 02:02:26.003003 2022    | Mon Jul 25 02:02:16 2022
 Sun Feb 25 02:02:26.003003 2024    | Sun Feb 25 02:02:08 2024
 Sat Sep 25 02:02:26.003003 2032    | Sat Sep 25 02:02:00 2032
 infinity                           | Tue Jan 09 04:00:21.551616 294277
(31 rows)

select t, time_bucket('3 days'::interval, t) from timestamps;
                 t                  |            time_bucket            
------------------------------------+-----------------------------------
 -infinity                          | Mon Jan 08 08:01:49.551616 294277
 Fri Jan 02 03:16:23.003003 3000 BC | Fri Jan 02 00:00:00 3000 BC
 Thu Apr 10 12:35:40.003003 1024 BC | Thu Apr 10 00:00:00 1024 BC
 Sat Jun 15 12:35:40.003003 0044 BC | Fri Jun 14 00:00:00 0044 BC
 Sun Jun 30 02:02:03.003003 0678    | Sat Jun 29 00:00:00 0678
 Sun Jul 03 02:02:04.003003 0794    | Sun Jul 03 00:00:00 0794
 Fri Jan 01 00:00:00 1700           | Thu Dec 31 00:00:00 1699
 Mon Dec 31 00:00:00 1962           | Sun Dec 30 00:00:00 1962
 Thu Jan 01 00:00:00 1970           | Thu Jan 01 00:00:00 1970
 Sat Dec 07 02:02:08.003003 1985    | Thu Dec 05 00:00:00 1985
 Wed Oct 18 02:02:09.003003 1989    | Wed Oct 18 00:00:00 1989
 Sun Jan 21 02:02:10.003003 1990    | Fri Jan 19 00:00:00 1990
 Sun Feb 10 02:02:11.003003 1991    | Sun Feb 10 00:00:00 1991
 Fri Sep 11 02:02:12.003003 1992    | Fri Sep 11 00:00:00 1992
 Mon Dec 26 02:02:13.003003 1994    | Sat Dec 24 00:00:00 1994
 Tue May 13 02:02:14.003003 1997    | Mon May 12 00:00:00 1997
 Sun Feb 14 02:02:15.003003 1999    | Sat Feb 13 00:00:00 1999
 Sat Jan 01 00:00:00 2000           | Fri Dec 31 00:00:00 1999
 Mon Jan 03 00:00:00 2000           | Mon Jan 03 00:00:00 2000
 Wed Sep 17 02:02:18.003003 2008    | Wed Sep 17 00:00:00 2008
 Wed Aug 18 02:02:19.003003 2010    | Tue Aug 17 00:00:00 2010
 Tue Mar 19 02:02:20.003003 2013    | Tue Mar 19 00:00:00 2013
 Thu Nov 20 02:02:21.003003 2014    | Tue Nov 18 00:00:00 2014
 Sun Feb 21 02:02:22.003003 2016    | Sat Feb 20 00:00:00 2016
 Wed Aug 22 02:02:23.003003 2018    | Mon Aug 20 00:00:00 2018
 Wed Jan 23 02:02:24.003003 2019    | Wed Jan 23 00:00:00 2019
 Mon Feb 24 02:02:25.003003 2020    | Sun Feb 23 00:00:00 2020
 Mon Jul 25 02:02:26.003003 2022    | Sun Jul 24 00:00:00 2022
 Sun Feb 25 02:02:26.003003 2024    | Fri Feb 23 00:00:00 2024
 Sat Sep 25 02:02:26.003003 2032    | Thu Sep 23 00:00:00 2032
 infinity                           | Mon Jan 08 08:01:49.551616 294277
(31 rows)

select t, time_bucket('3 years'::interval, t) from timestamps;
                 t                  |            time_bucket            
------------------------------------+-----------------------------------
 -infinity                          | Wed Jan 19 08:01:49.551616 294276
 Fri Jan 02 03:16:23.003003 3000 BC | Tue Jan 01 00:00:00 3002 BC
 Thu Apr 10 12:35:40.003003 1024 BC | Mon Jan 01 00:00:00 1025 BC
 Sat Jun 15 12:35:40.003003 0044 BC | Tue Jan 01 00:00:00 0044 BC
 Sun Jun 30 02:02:03.003003 0678    | Mon Jan 01 00:00:00 0677
 Sun Jul 03 02:02:04.003003 0794    | Sat Jan 01 00:00:00 0794
 Fri Jan 01 00:00:00 1700           | Fri Jan 01 00:00:00 1700
 Mon Dec 31 00:00:00 1962           | Sun Jan 01 00:00:00 1961
 Thu Jan 01 00:00:00 1970           | Thu Jan 01 00:00:00 1970
 Sat Dec 07 02:02:08.003003 1985    | Tue Jan 01 00:00:00 1985
 Wed Oct 18 02:02:09.003003 1989    | Fri Jan 01 00:00:00 1988
 Sun Jan 21 02:02:10.003003 1990    | Fri Jan 01 00:00:00 1988
 Sun Feb 10 02:02:11.003003 1991    | Tue Jan 01 00:00:00 1991
 Fri Sep 11 02:02:12.003003 1992    | Tue Jan 01 00:00:00 1991
 Mon Dec 26 02:02:13.003003 1994    | Sat Jan 01 00:00:00 1994
 Tue May 13 02:02:14.003003 1997    | Wed Jan 01 00:00:00 1997
 Sun Feb 14 02:02:15.003003 1999    | Wed Jan 01 00:00:00 1997
 Sat Jan 01 00:00:00 2000           | Sat Jan 01 00:00:00 2000
 Mon Jan 03 00:00:00 2000           | Sat Jan 01 00:00:00 2000
 Wed Sep 17 02:02:18.003003 2008    | Sun Jan 01 00:00:00 2006
 Wed Aug 18 02:02:19.003003 2010    | Thu Jan 01 00:00:00 2009
 Tue Mar 19 02:02:20.003003 2013    | Sun Jan 01 00:00:00 2012
 Thu Nov 20 02:02:21.003003 2014    | Sun Jan 01 00:00:00 2012
 Sun Feb 21 02:02:22.003003 2016    | Thu Jan 01 00:00:00 2015
 Wed Aug 22 02:02:23.003003 2018    | Mon Jan 01 00:00:00 2018
 Wed Jan 23 02:02:24.003003 2019    | Mon Jan 01 00:00:00 2018
 Mon Feb 24 02:02:25.003003 2020    | Mon Jan 01 00:00:00 2018
 Mon Jul 25 02:02:26.003003 2022    | Fri Jan 01 00:00:00 2021
 Sun Feb 25 02:02:26.003003 2024    | Mon Jan 01 00:00:00 2024
 Sat Sep 25 02:02:26.003003 2032    | Tue Jan 01 00:00:00 2030
 infinity                           | Wed Jan 19 08:01:49.551616 294276
(31 rows)

select t, time_bucket(null::interval, t) from timestamps;
                 t                  | time_bucket 
------------------------------------+-------------
 -infinity                          | 
 Fri Jan 02 03:16:23.003003 3000 BC | 
 Thu Apr 10 12:35:40.003003 1024 BC | 
 Sat Jun 15 12:35:40.003003 0044 BC | 
 Sun Jun 30 02:02:03.003003 0678    | 
 Sun Jul 03 02:02:04.003003 0794    | 
 Fri Jan 01 00:00:00 1700           | 
 Mon Dec 31 00:00:00 1962           | 
 Thu Jan 01 00:00:00 1970           | 
 Sat Dec 07 02:02:08.003003 1985    | 
 Wed Oct 18 02:02:09.003003 1989    | 
 Sun Jan 21 02:02:10.003003 1990    | 
 Sun Feb 10 02:02:11.003003 1991    | 
 Fri Sep 11 02:02:12.003003 1992    | 
 Mon Dec 26 02:02:13.003003 1994    | 
 Tue May 13 02:02:14.003003 1997    | 
 Sun Feb 14 02:02:15.003003 1999    | 
 Sat Jan 01 00:00:00 2000           | 
 Mon Jan 03 00:00:00 2000           | 
 Wed Sep 17 02:02:18.003003 2008    | 
 Wed Aug 18 02:02:19.003003 2010    | 
 Tue Mar 19 02:02:20.003003 2013    | 
 Thu Nov 20 02:02:21.003003 2014    | 
 Sun Feb 21 02:02:22.003003 2016    | 
 Wed Aug 22 02:02:23.003003 2018    | 
 Wed Jan 23 02:02:24.003003 2019    | 
 Mon Feb 24 02:02:25.003003 2020    | 
 Mon Jul 25 02:02:26.003003 2022    | 
 Sun Feb 25 02:02:26.003003 2024    | 
 Sat Sep 25 02:02:26.003003 2032    | 
 infinity                           | 
(31 rows)

select time_bucket('3 years'::interval, null::timestamp) from timestamps;
 time_bucket 
-------------
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
(31 rows)

select w, t, time_bucket(w, t) from timestamps;
         w         |                 t                  |            time_bucket            
-------------------+------------------------------------+-----------------------------------
 @ 10 days         | -infinity                          | Tue Jan 02 08:01:49.551616 294277
 @ 10 days         | Fri Jan 02 03:16:23.003003 3000 BC | Wed Dec 31 00:00:00 3001 BC
 @ 2 mons          | Thu Apr 10 12:35:40.003003 1024 BC | Sat Mar 01 00:00:00 1024 BC
 @ 10 days         | Sat Jun 15 12:35:40.003003 0044 BC | Wed Jun 12 00:00:00 0044 BC
 @ 0.000333 secs   | Sun Jun 30 02:02:03.003003 0678    | Sun Jun 30 02:02:03.002739 0678
 @ 0.000333 secs   | Sun Jul 03 02:02:04.003003 0794    | Sun Jul 03 02:02:04.002819 0794
 @ 0.000333 secs   | Fri Jan 01 00:00:00 1700           | Thu Dec 31 23:59:59.999937 1699
 @ 0.333 secs      | Mon Dec 31 00:00:00 1962           | Sun Dec 30 23:59:59.838 1962
 @ 0.333 secs      | Thu Jan 01 00:00:00 1970           | Wed Dec 31 23:59:59.739 1969
 @ 0.333 secs      | Sat Dec 07 02:02:08.003003 1985    | Sat Dec 07 02:02:07.872 1985
 @ 5 mins 33 secs  | Wed Oct 18 02:02:09.003003 1989    | Wed Oct 18 01:58:21 1989
 @ 5 mins 33 secs  | Sun Jan 21 02:02:10.003003 1990    | Sun Jan 21 02:00:18 1990
 @ 5 mins 33 secs  | Sun Feb 10 02:02:11.003003 1991    | Sun Feb 10 02:00:54 1991
 @ 5 hours 33 mins | Fri Sep 11 02:02:12.003003 1992    | Thu Sep 10 23:42:00 1992
 @ 5 hours 33 mins | Mon Dec 26 02:02:13.003003 1994    | Sun Dec 25 22:57:00 1994
 @ 5 hours 33 mins | Tue May 13 02:02:14.003003 1997    | Mon May 12 23:51:00 1997
 @ 333 hours       | Sun Feb 14 02:02:15.003003 1999    | Thu Feb 04 00:00:00 1999
 @ 333 hours       | Sat Jan 01 00:00:00 2000           | Mon Dec 20 03:00:00 1999
 @ 333 hours       | Mon Jan 03 00:00:00 2000           | Mon Jan 03 00:00:00 2000
 @ 10 days         | Wed Sep 17 02:02:18.003003 2008    | Wed Sep 17 00:00:00 2008
 @ 7 days          | Wed Aug 18 02:02:19.003003 2010    | Mon Aug 16 00:00:00 2010
 @ 10 days         | Tue Mar 19 02:02:20.003003 2013    | Fri Mar 15 00:00:00 2013
 @ 10 days         | Thu Nov 20 02:02:21.003003 2014    | Sat Nov 15 00:00:00 2014
 @ 2 mons          | Sun Feb 21 02:02:22.003003 2016    | Fri Jan 01 00:00:00 2016
 @ 2 mons          | Wed Aug 22 02:02:23.003003 2018    | Sun Jul 01 00:00:00 2018
 @ 2 mons          | Wed Jan 23 02:02:24.003003 2019    | Tue Jan 01 00:00:00 2019
 @ 2 years         | Mon Feb 24 02:02:25.003003 2020    | Wed Jan 01 00:00:00 2020
 @ 2 years         | Mon Jul 25 02:02:26.003003 2022    | Sat Jan 01 00:00:00 2022
 @ 10 days         | Sun Feb 25 02:02:26.003003 2024    | Fri Feb 16 00:00:00 2024
 @ 10 days         | Sat Sep 25 02:02:26.003003 2032    | Tue Sep 21 00:00:00 2032
 @ 10 days         | infinity                           | Tue Jan 02 08:01:49.551616 294277
(31 rows)

select t, time_bucket('4 seconds'::interval, t, '2 seconds'::interval) from timestamps;
                 t                  |            time_bucket            
------------------------------------+-----------------------------------
 -infinity                          | Tue Jan 09 04:00:51.551616 294277
 Fri Jan 02 03:16:23.003003 3000 BC | Fri Jan 02 03:16:22 3000 BC
 Thu Apr 10 12:35:40.003003 1024 BC | Thu Apr 10 12:35:38 1024 BC
 Sat Jun 15 12:35:40.003003 0044 BC | Sat Jun 15 12:35:38 0044 BC
 Sun Jun 30 02:02:03.003003 0678    | Sun Jun 30 02:02:02 0678
 Sun Jul 03 02:02:04.003003 0794    | Sun Jul 03 02:02:02 0794
 Fri Jan 01 00:00:00 1700           | Thu Dec 31 23:59:58 1699
 Mon Dec 31 00:00:00 1962           | Sun Dec 30 23:59:58 1962
 Thu Jan 01 00:00:00 1970           | Wed Dec 31 23:59:58 1969
 Sat Dec 07 02:02:08.003003 1985    | Sat Dec 07 02:02:06 1985
 Wed Oct 18 02:02:09.003003 1989    | Wed Oct 18 02:02:06 1989
 Sun Jan 21 02:02:10.003003 1990    | Sun Jan 21 02:02:10 1990
 Sun Feb 10 02:02:11.003003 1991    | Sun Feb 10 02:02:10 1991
 Fri Sep 11 02:02:12.003003 1992    | Fri Sep 11 02:02:10 1992
 Mon Dec 26 02:02:13.003003 1994    | Mon Dec 26 02:02:10 1994
 Tue May 13 02:02:14.003003 1997    | Tue May 13 02:02:14 1997
 Sun Feb 14 02:02:15.003003 1999    | Sun Feb 14 02:02:14 1999
 Sat Jan 01 00:00:00 2000           | Fri Dec 31 23:59:58 1999
 Mon Jan 03 00:00:00 2000           | Sun Jan 02 23:59:58 2000
 Wed Sep 17 02:02:18.003003 2008    | Wed Sep 17 02:02:18 2008
 Wed Aug 18 02:02:19.003003 2010    | Wed Aug 18 02:02:18 2010
 Tue Mar 19 02:02:20.003003 2013    | Tue Mar 19 02:02:18 2013
 Thu Nov 20 02:02:21.003003 2014    | Thu Nov 20 02:02:18 2014
 Sun Feb 21 02:02:22.003003 2016    | Sun Feb 21 02:02:22 2016
 Wed Aug 22 02:02:23.003003 2018    | Wed Aug 22 02:02:22 2018
 Wed Jan 23 02:02:24.003003 2019    | Wed Jan 23 02:02:22 2019
 Mon Feb 24 02:02:25.003003 2020    | Mon Feb 24 02:02:22 2020
 Mon Jul 25 02:02:26.003003 2022    | Mon Jul 25 02:02:26 2022
 Sun Feb 25 02:02:26.003003 2024    | Sun Feb 25 02:02:26 2024
 Sat Sep 25 02:02:26.003003 2032    | Sat Sep 25 02:02:26 2032
 infinity                           | Tue Jan 09 04:00:51.551616 294277
(31 rows)

select t, time_bucket('4 days'::interval, t, '6 hours'::interval) from timestamps;
                 t                  |            time_bucket            
------------------------------------+-----------------------------------
 -infinity                          | Sat Jan 06 14:01:49.551616 294277
 Fri Jan 02 03:16:23.003003 3000 BC | Mon Dec 29 06:00:00 3001 BC
 Thu Apr 10 12:35:40.003003 1024 BC | Tue Apr 08 06:00:00 1024 BC
 Sat Jun 15 12:35:40.003003 0044 BC | Fri Jun 14 06:00:00 0044 BC
 Sun Jun 30 02:02:03.003003 0678    | Wed Jun 26 06:00:00 0678
 Sun Jul 03 02:02:04.003003 0794    | Thu Jun 30 06:00:00 0794
 Fri Jan 01 00:00:00 1700           | Wed Dec 30 06:00:00 1699
 Mon Dec 31 00:00:00 1962           | Fri Dec 28 06:00:00 1962
 Thu Jan 01 00:00:00 1970           | Wed Dec 31 06:00:00 1969
 Sat Dec 07 02:02:08.003003 1985    | Tue Dec 03 06:00:00 1985
 Wed Oct 18 02:02:09.003003 1989    | Sun Oct 15 06:00:00 1989
 Sun Jan 21 02:02:10.003003 1990    | Fri Jan 19 06:00:00 1990
 Sun Feb 10 02:02:11.003003 1991    | Thu Feb 07 06:00:00 1991
 Fri Sep 11 02:02:12.003003 1992    | Wed Sep 09 06:00:00 1992
 Mon Dec 26 02:02:13.003003 1994    | Sat Dec 24 06:00:00 1994
 Tue May 13 02:02:14.003003 1997    | Sat May 10 06:00:00 1997
 Sun Feb 14 02:02:15.003003 1999    | Sat Feb 13 06:00:00 1999
 Sat Jan 01 00:00:00 2000           | Thu Dec 30 06:00:00 1999
 Mon Jan 03 00:00:00 2000           | Thu Dec 30 06:00:00 1999
 Wed Sep 17 02:02:18.003003 2008    | Sat Sep 13 06:00:00 2008
 Wed Aug 18 02:02:19.003003 2010    | Sat Aug 14 06:00:00 2010
 Tue Mar 19 02:02:20.003003 2013    | Fri Mar 15 06:00:00 2013
 Thu Nov 20 02:02:21.003003 2014    | Mon Nov 17 06:00:00 2014
 Sun Feb 21 02:02:22.003003 2016    | Sat Feb 20 06:00:00 2016
 Wed Aug 22 02:02:23.003003 2018    | Mon Aug 20 06:00:00 2018
 Wed Jan 23 02:02:24.003003 2019    | Sat Jan 19 06:00:00 2019
 Mon Feb 24 02:02:25.003003 2020    | Sun Feb 23 06:00:00 2020
 Mon Jul 25 02:02:26.003003 2022    | Fri Jul 22 06:00:00 2022
 Sun Feb 25 02:02:26.003003 2024    | Thu Feb 22 06:00:00 2024
 Sat Sep 25 02:02:26.003003 2032    | Thu Sep 23 06:00:00 2032
 infinity                           | Sat Jan 06 14:01:49.551616 294277
(31 rows)

select t, time_bucket('3 months'::interval, t, '6 days 11 hours'::interval) from timestamps;
                 t                  |            time_bucket            
------------------------------------+-----------------------------------
 -infinity                          | Tue Oct 24 19:01:49.551616 294276
 Fri Jan 02 03:16:23.003003 3000 BC | Tue Oct 07 11:00:00 3001 BC
 Thu Apr 10 12:35:40.003003 1024 BC | Mon Apr 07 11:00:00 1024 BC
 Sat Jun 15 12:35:40.003003 0044 BC | Sun Apr 07 11:00:00 0044 BC
 Sun Jun 30 02:02:03.003003 0678    | Sun Apr 07 11:00:00 0678
 Sun Jul 03 02:02:04.003003 0794    | Thu Apr 07 11:00:00 0794
 Fri Jan 01 00:00:00 1700           | Wed Oct 07 11:00:00 1699
 Mon Dec 31 00:00:00 1962           | Sun Oct 07 11:00:00 1962
 Thu Jan 01 00:00:00 1970           | Tue Oct 07 11:00:00 1969
 Sat Dec 07 02:02:08.003003 1985    | Mon Oct 07 11:00:00 1985
 Wed Oct 18 02:02:09.003003 1989    | Sat Oct 07 11:00:00 1989
 Sun Jan 21 02:02:10.003003 1990    | Sun Jan 07 11:00:00 1990
 Sun Feb 10 02:02:11.003003 1991    | Mon Jan 07 11:00:00 1991
 Fri Sep 11 02:02:12.003003 1992    | Tue Jul 07 11:00:00 1992
 Mon Dec 26 02:02:13.003003 1994    | Fri Oct 07 11:00:00 1994
 Tue May 13 02:02:14.003003 1997    | Mon Apr 07 11:00:00 1997
 Sun Feb 14 02:02:15.003003 1999    | Thu Jan 07 11:00:00 1999
 Sat Jan 01 00:00:00 2000           | Thu Oct 07 11:00:00 1999
 Mon Jan 03 00:00:00 2000           | Thu Oct 07 11:00:00 1999
 Wed Sep 17 02:02:18.003003 2008    | Mon Jul 07 11:00:00 2008
 Wed Aug 18 02:02:19.003003 2010    | Wed Jul 07 11:00:00 2010
 Tue Mar 19 02:02:20.003003 2013    | Mon Jan 07 11:00:00 2013
 Thu Nov 20 02:02:21.003003 2014    | Tue Oct 07 11:00:00 2014
 Sun Feb 21 02:02:22.003003 2016    | Thu Jan 07 11:00:00 2016
 Wed Aug 22 02:02:23.003003 2018    | Sat Jul 07 11:00:00 2018
 Wed Jan 23 02:02:24.003003 2019    | Mon Jan 07 11:00:00 2019
 Mon Feb 24 02:02:25.003003 2020    | Tue Jan 07 11:00:00 2020
 Mon Jul 25 02:02:26.003003 2022    | Thu Jul 07 11:00:00 2022
 Sun Feb 25 02:02:26.003003 2024    | Sun Jan 07 11:00:00 2024
 Sat Sep 25 02:02:26.003003 2032    | Wed Jul 07 11:00:00 2032
 infinity                           | Tue Oct 24 19:01:49.551616 294276
(31 rows)

select t, time_bucket(null::interval, t, '2 seconds'::interval) from timestamps;
                 t                  | time_bucket 
------------------------------------+-------------
 -infinity                          | 
 Fri Jan 02 03:16:23.003003 3000 BC | 
 Thu Apr 10 12:35:40.003003 1024 BC | 
 Sat Jun 15 12:35:40.003003 0044 BC | 
 Sun Jun 30 02:02:03.003003 0678    | 
 Sun Jul 03 02:02:04.003003 0794    | 
 Fri Jan 01 00:00:00 1700           | 
 Mon Dec 31 00:00:00 1962           | 
 Thu Jan 01 00:00:00 1970           | 
 Sat Dec 07 02:02:08.003003 1985    | 
 Wed Oct 18 02:02:09.003003 1989    | 
 Sun Jan 21 02:02:10.003003 1990    | 
 Sun Feb 10 02:02:11.003003 1991    | 
 Fri Sep 11 02:02:12.003003 1992    | 
 Mon Dec 26 02:02:13.003003 1994    | 
 Tue May 13 02:02:14.003003 1997    | 
 Sun Feb 14 02:02:15.003003 1999    | 
 Sat Jan 01 00:00:00 2000           | 
 Mon Jan 03 00:00:00 2000           | 
 Wed Sep 17 02:02:18.003003 2008    | 
 Wed Aug 18 02:02:19.003003 2010    | 
 Tue Mar 19 02:02:20.003003 2013    | 
 Thu Nov 20 02:02:21.003003 2014    | 
 Sun Feb 21 02:02:22.003003 2016    | 
 Wed Aug 22 02:02:23.003003 2018    | 
 Wed Jan 23 02:02:24.003003 2019    | 
 Mon Feb 24 02:02:25.003003 2020    | 
 Mon Jul 25 02:02:26.003003 2022    | 
 Sun Feb 25 02:02:26.003003 2024    | 
 Sat Sep 25 02:02:26.003003 2032    | 
 infinity                           | 
(31 rows)

select time_bucket('3 months'::interval, null::timestamp, '2 seconds'::interval) from timestamps;
 time_bucket 
-------------
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
(31 rows)

select t, time_bucket('3 months'::interval, t, null::interval) from timestamps;
                 t                  | time_bucket 
------------------------------------+-------------
 -infinity                          | 
 Fri Jan 02 03:16:23.003003 3000 BC | 
 Thu Apr 10 12:35:40.003003 1024 BC | 
 Sat Jun 15 12:35:40.003003 0044 BC | 
 Sun Jun 30 02:02:03.003003 0678    | 
 Sun Jul 03 02:02:04.003003 0794    | 
 Fri Jan 01 00:00:00 1700           | 
 Mon Dec 31 00:00:00 1962           | 
 Thu Jan 01 00:00:00 1970           | 
 Sat Dec 07 02:02:08.003003 1985    | 
 Wed Oct 18 02:02:09.003003 1989    | 
 Sun Jan 21 02:02:10.003003 1990    | 
 Sun Feb 10 02:02:11.003003 1991    | 
 Fri Sep 11 02:02:12.003003 1992    | 
 Mon Dec 26 02:02:13.003003 1994    | 
 Tue May 13 02:02:14.003003 1997    | 
 Sun Feb 14 02:02:15.003003 1999    | 
 Sat Jan 01 00:00:00 2000           | 
 Mon Jan 03 00:00:00 2000           | 
 Wed Sep 17 02:02:18.003003 2008    | 
 Wed Aug 18 02:02:19.003003 2010    | 
 Tue Mar 19 02:02:20.003003 2013    | 
 Thu Nov 20 02:02:21.003003 2014    | 
 Sun Feb 21 02:02:22.003003 2016    | 
 Wed Aug 22 02:02:23.003003 2018    | 
 Wed Jan 23 02:02:24.003003 2019    | 
 Mon Feb 24 02:02:25.003003 2020    | 
 Mon Jul 25 02:02:26.003003 2022    | 
 Sun Feb 25 02:02:26.003003 2024    | 
 Sat Sep 25 02:02:26.003003 2032    | 
 infinity                           | 
(31 rows)

select w, t, shift, time_bucket(w, t, shift) from timestamps;
         w         |                 t                  |         shift         |            time_bucket            
-------------------+------------------------------------+-----------------------+-----------------------------------
 @ 10 days         | -infinity                          | @ 0                   | Tue Jan 02 08:01:49.551616 294277
 @ 10 days         | Fri Jan 02 03:16:23.003003 3000 BC | @ 3 days              | Wed Dec 24 00:00:00 3001 BC
 @ 2 mons          | Thu Apr 10 12:35:40.003003 1024 BC | @ 10 days             | Tue Mar 11 00:00:00 1024 BC
 @ 10 days         | Sat Jun 15 12:35:40.003003 0044 BC | @ 6 days              | Sat Jun 08 00:00:00 0044 BC
 @ 0.000333 secs   | Sun Jun 30 02:02:03.003003 0678    | @ 0                   | Sun Jun 30 02:02:03.002739 0678
 @ 0.000333 secs   | Sun Jul 03 02:02:04.003003 0794    | @ 0.000444 secs       | Sun Jul 03 02:02:04.00293 0794
 @ 0.000333 secs   | Fri Jan 01 00:00:00 1700           | @ 0.000444 secs ago   | Thu Dec 31 23:59:59.999826 1699
 @ 0.333 secs      | Mon Dec 31 00:00:00 1962           | @ 0                   | Sun Dec 30 23:59:59.838 1962
 @ 0.333 secs      | Thu Jan 01 00:00:00 1970           | @ 0.444 secs          | Wed Dec 31 23:59:59.85 1969
 @ 0.333 secs      | Sat Dec 07 02:02:08.003003 1985    | @ 0.444 secs ago      | Sat Dec 07 02:02:07.761 1985
 @ 5 mins 33 secs  | Wed Oct 18 02:02:09.003003 1989    | @ 0                   | Wed Oct 18 01:58:21 1989
 @ 5 mins 33 secs  | Sun Jan 21 02:02:10.003003 1990    | @ 7 mins 24 secs      | Sun Jan 21 02:02:09 1990
 @ 5 mins 33 secs  | Sun Feb 10 02:02:11.003003 1991    | @ 7 mins 24 secs ago  | Sun Feb 10 01:59:03 1991
 @ 5 hours 33 mins | Fri Sep 11 02:02:12.003003 1992    | @ 0                   | Thu Sep 10 23:42:00 1992
 @ 5 hours 33 mins | Mon Dec 26 02:02:13.003003 1994    | @ 7 hours 24 mins     | Mon Dec 26 00:48:00 1994
 @ 5 hours 33 mins | Tue May 13 02:02:14.003003 1997    | @ 7 hours 24 mins ago | Mon May 12 22:00:00 1997
 @ 333 hours       | Sun Feb 14 02:02:15.003003 1999    | @ 0                   | Thu Feb 04 00:00:00 1999
 @ 333 hours       | Sat Jan 01 00:00:00 2000           | @ 444 hours           | Fri Dec 24 18:00:00 1999
 @ 333 hours       | Mon Jan 03 00:00:00 2000           | @ 444 hours ago       | Wed Dec 29 09:00:00 1999
 @ 10 days         | Wed Sep 17 02:02:18.003003 2008    | @ 0                   | Wed Sep 17 00:00:00 2008
 @ 7 days          | Wed Aug 18 02:02:19.003003 2010    | @ 0                   | Mon Aug 16 00:00:00 2010
 @ 10 days         | Tue Mar 19 02:02:20.003003 2013    | @ 2 days 4 hours      | Sun Mar 17 04:00:00 2013
 @ 10 days         | Thu Nov 20 02:02:21.003003 2014    | @ 2 days -4 hours ago | Thu Nov 13 04:00:00 2014
 @ 2 mons          | Sun Feb 21 02:02:22.003003 2016    | @ 0                   | Fri Jan 01 00:00:00 2016
 @ 2 mons          | Wed Aug 22 02:02:23.003003 2018    | @ 1 mon 7 days        | Wed Aug 08 00:00:00 2018
 @ 2 mons          | Wed Jan 23 02:02:24.003003 2019    | @ 1 mon -7 days ago   | Sat Dec 08 00:00:00 2018
 @ 2 years         | Mon Feb 24 02:02:25.003003 2020    | @ 6 mons              | Sun Jul 01 00:00:00 2018
 @ 2 years         | Mon Jul 25 02:02:26.003003 2022    | @ 6 mons ago          | Thu Jul 01 00:00:00 2021
 @ 10 days         | Sun Feb 25 02:02:26.003003 2024    | @ 1 year              | Wed Feb 21 00:00:00 2024
 @ 10 days         | Sat Sep 25 02:02:26.003003 2032    | @ 1 year ago          | Thu Sep 16 00:00:00 2032
 @ 10 days         | infinity                           | @ 0                   | Tue Jan 02 08:01:49.551616 294277
(31 rows)

select t, time_bucket('11 seconds'::interval, t, '1990-12-10 08:08:10'::timestamp) from timestamps;
                 t                  |            time_bucket            
------------------------------------+-----------------------------------
 -infinity                          | Tue Jan 09 04:00:50.551616 294277
 Fri Jan 02 03:16:23.003003 3000 BC | Fri Jan 02 03:16:19 3000 BC
 Thu Apr 10 12:35:40.003003 1024 BC | Thu Apr 10 12:35:30 1024 BC
 Sat Jun 15 12:35:40.003003 0044 BC | Sat Jun 15 12:35:37 0044 BC
 Sun Jun 30 02:02:03.003003 0678    | Sun Jun 30 02:01:59 0678
 Sun Jul 03 02:02:04.003003 0794    | Sun Jul 03 02:01:54 0794
 Fri Jan 01 00:00:00 1700           | Thu Dec 31 23:59:53 1699
 Mon Dec 31 00:00:00 1962           | Sun Dec 30 23:59:56 1962
 Thu Jan 01 00:00:00 1970           | Wed Dec 31 23:59:53 1969
 Sat Dec 07 02:02:08.003003 1985    | Sat Dec 07 02:01:59 1985
 Wed Oct 18 02:02:09.003003 1989    | Wed Oct 18 02:02:03 1989
 Sun Jan 21 02:02:10.003003 1990    | Sun Jan 21 02:02:05 1990
 Sun Feb 10 02:02:11.003003 1991    | Sun Feb 10 02:02:05 1991
 Fri Sep 11 02:02:12.003003 1992    | Fri Sep 11 02:02:07 1992
 Mon Dec 26 02:02:13.003003 1994    | Mon Dec 26 02:02:07 1994
 Tue May 13 02:02:14.003003 1997    | Tue May 13 02:02:07 1997
 Sun Feb 14 02:02:15.003003 1999    | Sun Feb 14 02:02:05 1999
 Sat Jan 01 00:00:00 2000           | Fri Dec 31 23:59:58 1999
 Mon Jan 03 00:00:00 2000           | Sun Jan 02 23:59:57 2000
 Wed Sep 17 02:02:18.003003 2008    | Wed Sep 17 02:02:08 2008
 Wed Aug 18 02:02:19.003003 2010    | Wed Aug 18 02:02:10 2010
 Tue Mar 19 02:02:20.003003 2013    | Tue Mar 19 02:02:11 2013
 Thu Nov 20 02:02:21.003003 2014    | Thu Nov 20 02:02:19 2014
 Sun Feb 21 02:02:22.003003 2016    | Sun Feb 21 02:02:21 2016
 Wed Aug 22 02:02:23.003003 2018    | Wed Aug 22 02:02:21 2018
 Wed Jan 23 02:02:24.003003 2019    | Wed Jan 23 02:02:21 2019
 Mon Feb 24 02:02:25.003003 2020    | Mon Feb 24 02:02:15 2020
 Mon Jul 25 02:02:26.003003 2022    | Mon Jul 25 02:02:25 2022
 Sun Feb 25 02:02:26.003003 2024    | Sun Feb 25 02:02:21 2024
 Sat Sep 25 02:02:26.003003 2032    | Sat Sep 25 02:02:21 2032
 infinity                           | Tue Jan 09 04:00:50.551616 294277
(31 rows)

select t, time_bucket('11 days'::interval, t, '1990-01-06 08:08:10'::timestamp) from timestamps;
                 t                  |            time_bucket            
------------------------------------+-----------------------------------
 -infinity                          | Mon Jan 08 16:09:59.551616 294277
 Fri Jan 02 03:16:23.003003 3000 BC | Sat Dec 27 08:08:10 3001 BC
 Thu Apr 10 12:35:40.003003 1024 BC | Sun Apr 06 08:08:10 1024 BC
 Sat Jun 15 12:35:40.003003 0044 BC | Fri Jun 14 08:08:10 0044 BC
 Sun Jun 30 02:02:03.003003 0678    | Tue Jun 25 08:08:10 0678
 Sun Jul 03 02:02:04.003003 0794    | Wed Jun 29 08:08:10 0794
 Fri Jan 01 00:00:00 1700           | Sun Dec 27 08:08:10 1699
 Mon Dec 31 00:00:00 1962           | Fri Dec 21 08:08:10 1962
 Thu Jan 01 00:00:00 1970           | Sat Dec 27 08:08:10 1969
 Sat Dec 07 02:02:08.003003 1985    | Mon Dec 02 08:08:10 1985
 Wed Oct 18 02:02:09.003003 1989    | Tue Oct 10 08:08:10 1989
 Sun Jan 21 02:02:10.003003 1990    | Wed Jan 17 08:08:10 1990
 Sun Feb 10 02:02:11.003003 1991    | Wed Feb 06 08:08:10 1991
 Fri Sep 11 02:02:12.003003 1992    | Mon Aug 31 08:08:10 1992
 Mon Dec 26 02:02:13.003003 1994    | Thu Dec 15 08:08:10 1994
 Tue May 13 02:02:14.003003 1997    | Fri May 02 08:08:10 1997
 Sun Feb 14 02:02:15.003003 1999    | Wed Feb 10 08:08:10 1999
 Sat Jan 01 00:00:00 2000           | Sun Dec 26 08:08:10 1999
 Mon Jan 03 00:00:00 2000           | Sun Dec 26 08:08:10 1999
 Wed Sep 17 02:02:18.003003 2008    | Mon Sep 08 08:08:10 2008
 Wed Aug 18 02:02:19.003003 2010    | Fri Aug 13 08:08:10 2010
 Tue Mar 19 02:02:20.003003 2013    | Sat Mar 16 08:08:10 2013
 Thu Nov 20 02:02:21.003003 2014    | Tue Nov 11 08:08:10 2014
 Sun Feb 21 02:02:22.003003 2016    | Tue Feb 16 08:08:10 2016
 Wed Aug 22 02:02:23.003003 2018    | Fri Aug 17 08:08:10 2018
 Wed Jan 23 02:02:24.003003 2019    | Fri Jan 18 08:08:10 2019
 Mon Feb 24 02:02:25.003003 2020    | Tue Feb 18 08:08:10 2020
 Mon Jul 25 02:02:26.003003 2022    | Sun Jul 17 08:08:10 2022
 Sun Feb 25 02:02:26.003003 2024    | Tue Feb 20 08:08:10 2024
 Sat Sep 25 02:02:26.003003 2032    | Mon Sep 20 08:08:10 2032
 infinity                           | Mon Jan 08 16:09:59.551616 294277
(31 rows)

select t, time_bucket('7 months'::interval, t, '1990-01-06 08:08:10'::timestamp) from timestamps;
                 t                  |            time_bucket            
------------------------------------+-----------------------------------
 -infinity                          | Tue Jul 18 08:01:49.551616 294276
 Fri Jan 02 03:16:23.003003 3000 BC | Wed Oct 01 00:00:00 3001 BC
 Thu Apr 10 12:35:40.003003 1024 BC | Sat Feb 01 00:00:00 1024 BC
 Sat Jun 15 12:35:40.003003 0044 BC | Fri Feb 01 00:00:00 0044 BC
 Sun Jun 30 02:02:03.003003 0678    | Fri Feb 01 00:00:00 0678
 Sun Jul 03 02:02:04.003003 0794    | Tue Mar 01 00:00:00 0794
 Fri Jan 01 00:00:00 1700           | Wed Jul 01 00:00:00 1699
 Mon Dec 31 00:00:00 1962           | Wed Aug 01 00:00:00 1962
 Thu Jan 01 00:00:00 1970           | Fri Aug 01 00:00:00 1969
 Sat Dec 07 02:02:08.003003 1985    | Sun Dec 01 00:00:00 1985
 Wed Oct 18 02:02:09.003003 1989    | Thu Jun 01 00:00:00 1989
 Sun Jan 21 02:02:10.003003 1990    | Mon Jan 01 00:00:00 1990
 Sun Feb 10 02:02:11.003003 1991    | Wed Aug 01 00:00:00 1990
 Fri Sep 11 02:02:12.003003 1992    | Fri May 01 00:00:00 1992
 Mon Dec 26 02:02:13.003003 1994    | Thu Sep 01 00:00:00 1994
 Tue May 13 02:02:14.003003 1997    | Wed Jan 01 00:00:00 1997
 Sun Feb 14 02:02:15.003003 1999    | Thu Oct 01 00:00:00 1998
 Sat Jan 01 00:00:00 2000           | Wed Dec 01 00:00:00 1999
 Mon Jan 03 00:00:00 2000           | Wed Dec 01 00:00:00 1999
 Wed Sep 17 02:02:18.003003 2008    | Mon Sep 01 00:00:00 2008
 Wed Aug 18 02:02:19.003003 2010    | Tue Jun 01 00:00:00 2010
 Tue Mar 19 02:02:20.003003 2013    | Mon Oct 01 00:00:00 2012
 Thu Nov 20 02:02:21.003003 2014    | Tue Jul 01 00:00:00 2014
 Sun Feb 21 02:02:22.003003 2016    | Tue Sep 01 00:00:00 2015
 Wed Aug 22 02:02:23.003003 2018    | Wed Aug 01 00:00:00 2018
 Wed Jan 23 02:02:24.003003 2019    | Wed Aug 01 00:00:00 2018
 Mon Feb 24 02:02:25.003003 2020    | Tue Oct 01 00:00:00 2019
 Mon Jul 25 02:02:26.003003 2022    | Tue Feb 01 00:00:00 2022
 Sun Feb 25 02:02:26.003003 2024    | Wed Nov 01 00:00:00 2023
 Sat Sep 25 02:02:26.003003 2032    | Sun Aug 01 00:00:00 2032
 infinity                           | Tue Jul 18 08:01:49.551616 294276
(31 rows)

select t, time_bucket(null::interval, t, '1990-01-06 08:08:10'::timestamp) from timestamps;
                 t                  | time_bucket 
------------------------------------+-------------
 -infinity                          | 
 Fri Jan 02 03:16:23.003003 3000 BC | 
 Thu Apr 10 12:35:40.003003 1024 BC | 
 Sat Jun 15 12:35:40.003003 0044 BC | 
 Sun Jun 30 02:02:03.003003 0678    | 
 Sun Jul 03 02:02:04.003003 0794    | 
 Fri Jan 01 00:00:00 1700           | 
 Mon Dec 31 00:00:00 1962           | 
 Thu Jan 01 00:00:00 1970           | 
 Sat Dec 07 02:02:08.003003 1985    | 
 Wed Oct 18 02:02:09.003003 1989    | 
 Sun Jan 21 02:02:10.003003 1990    | 
 Sun Feb 10 02:02:11.003003 1991    | 
 Fri Sep 11 02:02:12.003003 1992    | 
 Mon Dec 26 02:02:13.003003 1994    | 
 Tue May 13 02:02:14.003003 1997    | 
 Sun Feb 14 02:02:15.003003 1999    | 
 Sat Jan 01 00:00:00 2000           | 
 Mon Jan 03 00:00:00 2000           | 
 Wed Sep 17 02:02:18.003003 2008    | 
 Wed Aug 18 02:02:19.003003 2010    | 
 Tue Mar 19 02:02:20.003003 2013    | 
 Thu Nov 20 02:02:21.003003 2014    | 
 Sun Feb 21 02:02:22.003003 2016    | 
 Wed Aug 22 02:02:23.003003 2018    | 
 Wed Jan 23 02:02:24.003003 2019    | 
 Mon Feb 24 02:02:25.003003 2020    | 
 Mon Jul 25 02:02:26.003003 2022    | 
 Sun Feb 25 02:02:26.003003 2024    | 
 Sat Sep 25 02:02:26.003003 2032    | 
 infinity                           | 
(31 rows)

select time_bucket('7 months'::interval, null::timestamp, '1990-01-06 08:08:10'::timestamp) from timestamps;
 time_bucket 
-------------
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
(31 rows)

select t, time_bucket('7 months'::interval, t, null::timestamp) from timestamps;
                 t                  | time_bucket 
------------------------------------+-------------
 -infinity                          | 
 Fri Jan 02 03:16:23.003003 3000 BC | 
 Thu Apr 10 12:35:40.003003 1024 BC | 
 Sat Jun 15 12:35:40.003003 0044 BC | 
 Sun Jun 30 02:02:03.003003 0678    | 
 Sun Jul 03 02:02:04.003003 0794    | 
 Fri Jan 01 00:00:00 1700           | 
 Mon Dec 31 00:00:00 1962           | 
 Thu Jan 01 00:00:00 1970           | 
 Sat Dec 07 02:02:08.003003 1985    | 
 Wed Oct 18 02:02:09.003003 1989    | 
 Sun Jan 21 02:02:10.003003 1990    | 
 Sun Feb 10 02:02:11.003003 1991    | 
 Fri Sep 11 02:02:12.003003 1992    | 
 Mon Dec 26 02:02:13.003003 1994    | 
 Tue May 13 02:02:14.003003 1997    | 
 Sun Feb 14 02:02:15.003003 1999    | 
 Sat Jan 01 00:00:00 2000           | 
 Mon Jan 03 00:00:00 2000           | 
 Wed Sep 17 02:02:18.003003 2008    | 
 Wed Aug 18 02:02:19.003003 2010    | 
 Tue Mar 19 02:02:20.003003 2013    | 
 Thu Nov 20 02:02:21.003003 2014    | 
 Sun Feb 21 02:02:22.003003 2016    | 
 Wed Aug 22 02:02:23.003003 2018    | 
 Wed Jan 23 02:02:24.003003 2019    | 
 Mon Feb 24 02:02:25.003003 2020    | 
 Mon Jul 25 02:02:26.003003 2022    | 
 Sun Feb 25 02:02:26.003003 2024    | 
 Sat Sep 25 02:02:26.003003 2032    | 
 infinity                           | 
(31 rows)

select w, t, origin, time_bucket(w, t, origin) from timestamps;
         w         |                 t                  |             origin              |            time_bucket            
-------------------+------------------------------------+---------------------------------+-----------------------------------
 @ 10 days         | -infinity                          | Mon Jan 05 00:00:00 1970        | Sun Jan 07 08:01:49.551616 294277
 @ 10 days         | Fri Jan 02 03:16:23.003003 3000 BC | Thu Jan 01 00:00:00 3000 BC     | Thu Jan 01 00:00:00 3000 BC
 @ 2 mons          | Thu Apr 10 12:35:40.003003 1024 BC | Sat Mar 01 00:00:00 1024 BC     | Sat Mar 01 00:00:00 1024 BC
 @ 10 days         | Sat Jun 15 12:35:40.003003 0044 BC | Fri Feb 01 00:00:00 0044 BC     | Tue Jun 11 00:00:00 0044 BC
 @ 0.000333 secs   | Sun Jun 30 02:02:03.003003 0678    | Tue Feb 10 00:00:00 1970        | Sun Jun 30 02:02:03.002793 0678
 @ 0.000333 secs   | Sun Jul 03 02:02:04.003003 0794    | Sat Oct 17 00:05:05.006006 1970 | Sun Jul 03 02:02:04.002992 0794
 @ 0.000333 secs   | Fri Jan 01 00:00:00 1700           | Sun Sep 27 00:05:05.006006 1970 | Thu Dec 31 23:59:59.999714 1699
 @ 0.333 secs      | Mon Dec 31 00:00:00 1962           | Wed Aug 12 00:00:00 1970        | Sun Dec 30 23:59:59.919 1962
 @ 0.333 secs      | Thu Jan 01 00:00:00 1970           | Tue Jun 23 00:05:05.006006 1970 | Wed Dec 31 23:59:59.807006 1969
 @ 0.333 secs      | Sat Dec 07 02:02:08.003003 1985    | Mon Jan 05 00:05:05.006006 1970 | Sat Dec 07 02:02:07.724006 1985
 @ 5 mins 33 secs  | Wed Oct 18 02:02:09.003003 1989    | Mon Sep 07 00:00:00 1970        | Wed Oct 18 01:59:24 1989
 @ 5 mins 33 secs  | Sun Jan 21 02:02:10.003003 1990    | Mon Jul 06 00:05:05.006006 1970 | Sun Jan 21 02:01:11.006006 1990
 @ 5 mins 33 secs  | Sun Feb 10 02:02:11.003003 1991    | Fri Oct 09 00:05:05.006006 1970 | Sun Feb 10 01:59:50.006006 1991
 @ 5 hours 33 mins | Fri Sep 11 02:02:12.003003 1992    | Fri Apr 10 00:00:00 1970        | Thu Sep 10 22:48:00 1992
 @ 5 hours 33 mins | Mon Dec 26 02:02:13.003003 1994    | Thu Mar 05 00:05:05.006006 1970 | Sun Dec 25 23:56:05.006006 1994
 @ 5 hours 33 mins | Tue May 13 02:02:14.003003 1997    | Mon Jan 03 00:00:00 2000        | Mon May 12 23:51:00 1997
 @ 333 hours       | Sun Feb 14 02:02:15.003003 1999    | Sat Jan 01 00:00:00 2000        | Tue Feb 02 00:00:00 1999
 @ 333 hours       | Sat Jan 01 00:00:00 2000           | Tue Nov 25 00:05:05.006006 1980 | Tue Dec 21 06:05:05.006006 1999
 @ 333 hours       | Mon Jan 03 00:00:00 2000           | Thu Jan 05 00:05:05.006006 2045 | Fri Dec 31 03:05:05.006006 1999
 @ 10 days         | Wed Sep 17 02:02:18.003003 2008    | Thu Nov 05 00:00:00 2009        | Thu Sep 11 00:00:00 2008
 @ 7 days          | Wed Aug 18 02:02:19.003003 2010    | Sun Sep 05 00:00:00 2100        | Sun Aug 15 00:00:00 2010
 @ 10 days         | Tue Mar 19 02:02:20.003003 2013    | Sun Oct 07 00:05:05.006006 2300 | Fri Mar 15 00:05:05.006006 2013
 @ 10 days         | Thu Nov 20 02:02:21.003003 2014    | Mon Dec 07 00:05:05.006006 1970 | Sun Nov 16 00:05:05.006006 2014
 @ 2 mons          | Sun Feb 21 02:02:22.003003 2016    | Sat Sep 05 00:00:00 1970        | Fri Jan 01 00:00:00 2016
 @ 2 mons          | Wed Aug 22 02:02:23.003003 2018    | Wed Jul 01 00:05:05.006006 1970 | Sun Jul 01 00:00:00 2018
 @ 2 mons          | Wed Jan 23 02:02:24.003003 2019    | Mon Sep 01 00:05:05.006006 1969 | Tue Jan 01 00:00:00 2019
 @ 2 years         | Mon Feb 24 02:02:25.003003 2020    | Fri Feb 13 00:05:05.006006 1970 | Sat Feb 01 00:00:00 2020
 @ 2 years         | Mon Jul 25 02:02:26.003003 2022    | Thu Oct 09 00:05:05.006006 1969 | Fri Oct 01 00:00:00 2021
 @ 10 days         | Sun Feb 25 02:02:26.003003 2024    | -infinity                       | Thu Feb 22 19:59:05.224192 2024
 @ 10 days         | Sat Sep 25 02:02:26.003003 2032    | infinity                        | Fri Sep 17 19:59:05.224191 2032
 @ 10 days         | infinity                           | Thu Jan 01 00:00:00 1970        | Wed Jan 03 08:01:49.551616 294277
(31 rows)

select time_bucket('-3 hours'::interval, '2019-04-05 00:00:00'::timestamp);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Period must be greater than 0
select time_bucket('-3 hours'::interval, '2019-04-05 00:00:00'::timestamp, '1 hour 30 minutes':: interval);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Period must be greater than 0
select time_bucket('-3 hours'::interval, '2019-04-05 00:00:00'::timestamp, '2019-04-05 00:00:00'::timestamp);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Period must be greater than 0
select time_bucket('-1 month'::interval, '2019-04-05 00:00:00'::timestamp);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Period must be greater than 0
select time_bucket('-1 month'::interval, '2019-04-05 00:00:00'::timestamp, '1 hour 30 minutes':: interval);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Period must be greater than 0
select time_bucket('-1 month'::interval, '2019-04-05 00:00:00'::timestamp, '2018-04-05 00:00:00'::timestamp);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Period must be greater than 0
select time_bucket('1 day - 172800 seconds'::interval, '2018-05-05 00:00:00'::timestamp);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Period must be greater than 0
select time_bucket('1 day - 172800 seconds'::interval, '2018-05-05 00:00:00'::timestamp, '1 hour 30 minutes':: interval);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Period must be greater than 0
select time_bucket('1 day - 172800 seconds'::interval, '2018-05-05 00:00:00'::timestamp, '2018-05-05 00:00:00'::timestamp);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Period must be greater than 0
select time_bucket('1 month 1 day'::interval, '2018-05-05 00:00:00'::timestamp);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Month intervals cannot have day or time component
select time_bucket('1 month 1 day'::interval, '2018-05-05 00:00:00'::timestamp, '1 hour 30 minutes':: interval);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Month intervals cannot have day or time component
select time_bucket('1 month 1 day'::interval, '2018-05-05 00:00:00'::timestamp, '2018-05-05 00:00:00'::timestamp);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Not implemented Error: Month intervals cannot have day or time component
select time_bucket('3 days'::interval, '2019-05-05 00:00:00'::timestamp, '2000000000 months'::interval);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Conversion Error: Date out of range: -166664648-9-5
select time_bucket('3 days'::interval, '2019-05-05 00:00:00'::timestamp, '-2000000000 months'::interval);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Conversion Error: Date out of range: 166668686-1-5
select time_bucket('3 months'::interval, '2019-05-05 00:00:00'::timestamp, '2000000000 months'::interval);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Conversion Error: Date out of range: -166664648-9-5
select time_bucket('3 months'::interval, '2019-05-05 00:00:00'::timestamp, '-2000000000 months'::interval);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Conversion Error: Date out of range: 166668686-1-5
select time_bucket('1 microseconds'::interval, '290309-12-21 (BC) 23:59:59.999999'::timestamp);
ERROR:  timestamp out of range: "290309-12-21 (BC) 23:59:59.999999"
LINE 1: select time_bucket('1 microseconds'::interval, '290309-12-21...
                                                       ^
select time_bucket('1 microseconds'::interval, '290309-12-22 (BC) 00:00:00'::timestamp);
ERROR:  timestamp out of range: "290309-12-22 (BC) 00:00:00"
LINE 1: select time_bucket('1 microseconds'::interval, '290309-12-22...
                                                       ^
select time_bucket('1 microseconds'::interval, '294247-01-10 04:00:54.775807'::timestamp);
ERROR:  (PGDuckDB/Duckdb_ExecCustomScan_Cpp) Conversion Error: timestamp field value out of range: "294247-01-10 04:00:54.775807"

LINE 1: ...('@ 0.000001 secs'::interval, '294247-01-10 04:00:54.775807'::timestamp without time zone) AS time_bucket
                                                                       ^
select time_bucket('1 microseconds'::interval, '294247-01-10 04:00:54.775806'::timestamp);
            time_bucket            
-----------------------------------
 Sun Jan 10 04:00:54.775806 294247
(1 row)

select time_bucket('1 month 1 day'::interval, null::timestamp);
 time_bucket 
-------------
 
(1 row)

select time_bucket('1 month 1 day'::interval, null::timestamp, '6 days'::interval);
 time_bucket 
-------------
 
(1 row)

select time_bucket('1 month 1 day'::interval, null::timestamp, '2022-12-20 10:00:00'::timestamp);
 time_bucket 
-------------
 
(1 row)

select time_bucket('-1 month'::interval, null::timestamp);
 time_bucket 
-------------
 
(1 row)

select time_bucket('-1 month'::interval, null::timestamp, '6 days'::interval);
 time_bucket 
-------------
 
(1 row)

select time_bucket('-1 month'::interval, '2022-12-22 10:00:00'::timestamp, null::interval);
 time_bucket 
-------------
 
(1 row)

select time_bucket('-1 month'::interval, null::timestamp, '2022-12-20 10:00:00'::timestamp);
 time_bucket 
-------------
 
(1 row)

select time_bucket('-1 month'::interval, '2022-12-22'::timestamp, null::timestamp);
 time_bucket 
-------------
 
(1 row)

drop table dates, timestamps;
